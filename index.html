<!DOCTYPE html>
<html lang="en">
<head>
    <title>Xiaolangdi Dam Project</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="A Case Study for Xiaolangdi Dam on Yellow River" />
    <meta property="og:url" content="http://cdn.rawgit.com/winkyt/storymap/master/index.html" />
    <meta property="og:description" content="A case study for Geog541 mini project." />
    <meta property="og:image" content="img/social.png" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />

    <!--animation-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">

    <!--facebook and info icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--use a better font for this web map-->
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>


    <link rel="stylesheet" type="text/css" href="dist/storymap.css">
    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/water.png" type="image/x-icon">
    <style>
        .end-background-img {
            background: url(img/end.jpg) no-repeat center center fixed;
        }
    </style>

    <!--add required libraries-->
    <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--story map plugin-->
    <script src="dist/storymap.js"></script>

    <!-- bing map -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Promise"></script>
    <script src="http://gmaclennan.github.io/leaflet-bing-layer/leaflet-bing-layer.js"></script>

    <!-- mini globle map -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/globeminimap.js"></script>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 main">
            <section data-scene="overview">
                <video class="background-fullscreen-setting" playsinline autoplay muted loop>
                    <source src="assets/yellowriver.mp4" type="video/mp4">
                </video>
                <div class= "background-fullscreen-setting text-responsive text-center" >
                    <h3>A case study of Xiaolangdi on Yellow River</h3>
                    <h3><small style="color: rgba(102, 178, 255, 0.8)">This Web Map introduces the project of Xiaolangdi Dam in China.</small></h3>
                </div>
            </section>

            <section data-scene="yellowriver">
                <h2>The Mother River -- Yellow River</h2>
                <p>Yellow River is the second longest river in China, followed by Yangtze River. The Chinese civilization originated in the Yellow River Basin. However, the Yellow River has caused several deadly floods, including the only natural disasters in recorded history to have killed more than a million people. The floods are caused by the large amount of fine-grained sediment carried by the river from the Loess Plateau, which is continuously deposited along the bottom of its channel. The sedimentation causes natural dams to slowly accumulate. These subaqueous dams were unpredictable and generally undetectable. Eventually, the enormous amount of water has to find a new way to the sea, forcing it to take the path of least resistance. When this happens, it bursts out across the flat North China Plain, sometimes making a new channel and inundating any farmland, cities or towns in its path. Before modern dams came to China, the Yellow River was extremely prone to flooding. In the 2,540 years from 595 BCE to 1946 CE, the Yellow River has been estimated to have flooded 1,593 times, shifting its course 26 times noticeably and nine times severely.     </p>
                <img src="img/history%20.jpg" class="img-responsive" alt="responsive image" alt-text="Chairman Jiang at Site Selection">
                <p>Sanmenxia dam is the first major flood control project on the Yellow River. However, the accumulated sediment put too much pressure to the dam. Later, the dam had to be re-engineered and renovated. The failure of Sanmenxia placed the Chinese government at the center of controversy for water management on the Yellow River. Later, the government planned the Xiaolangdi project to offset the negative impact from Sanmenxia. </p>
            </section>

            <section data-scene="history">
                <h2>History</h2>
                <p>During the period of the Republic of China, the government planned to build a dam at the end of the midstream of the Yellow River. However, the project never started due to the complicated political environment at the time. After the establishment of the People's Republic of China, the government considered a dam project at the same location but finally settled on Sammenxia.</p>
                <p>In 1987, the state department approved the Xiaolangdi project.  On September 12, 1991, the project began preparation. In 1994, main construction started. At the end of 2001, the project finished. In general, the project was divided into four parts: preparation, bidding, construction, and inspection.</p>
                <p>To complete the Xiaolangdi project, a large amount of capital investment was needed. However, the country did not have enough financial support. Thus, the government decided to borrow a loan from the World Bank. </p>
                <p>Xiaolangdi Multipurpose Dam Project Management Bureau supervised the progress, quality of construction, security of construction, and investment in the project. </p>
                <p>Xiaolangdi Design Institute took responsibility for the design of the dam. The two parties were in a contractual relationship. At the time, separating the design and construction authority was novel. </p>

            </section>

            <section data-scene="construction">
                <h2>Construction</h2>
                <p>The main function of Xiaolangdi dam is flood control. Its function also includes sedimentation reduction, irrigation, and hydropower. Xiaolangdi construction was immense and complicated. Its management was in line with international standards. The project is known as one of the most challenging dam projects in the World. </p>
                <p>The project featured:</p>
                <p>1. complex technology</p>
                <p>2. difficult construction</p>
                <p>3. difficult contract management</p>
                <p>4. complex construction site management </p>
                <p>5. dam-induced displacement</p>
            </section>

            <section data-scene="stakeholders">
                <h2>Participants in the Project</h2>
                <p>The participants in this project were the owners (Xiaolangdi Multipurpose Dam Project Management Bureau), contractors, and supervising engineers.</p>
                <p>All stakeholders were interconnected but they also had independent management systems.</p>
                <p>Xiaolangdi Multipurpose Dam Project Management Bureau designed and supervised all plans, such as environment management and displacement plans. </p>
                <p>Contractors were responsible for purchasing materials and final construction. </p>
                <p>Supervising Engineers were responsbile for the quality of dam.</p>
            </section>

            <section data-scene="environment">
                <h2>Ecological Impact</h2>
                <p>The Yellow River supports 12% of the Chinese population and 17% of agricultural land. Also, there are 50 large and medium cities along the Yellow River. Since the 1990s, the risks of cutoff and sediment accumulation has increased. The government has been urged to find a new Yellow River management plan.</p>
                <p>The concept of Yellow River water management changed from "flood control" to "improve river health". The Xiaolangdi project is the key to achieving this goal.</p>
                <p>The location of the reservoir is at the end of Jinxia Gorge. It can catch the flow from the upstream and store it for yearly downstream sediment reduction. </p>
                <p>For example, in 2003, the size of the autumn flood was unusually large. The Xiaolangdi Reservoir caught multiple floods from upstream, which avoided significant damage downstream. </p>
                <p>In general, the Xiaolangdi dam project mitigates the risk of flooding downstream and secures the living envrinment for millions of people. </p>
            </section>

            <section data-scene="displacement">
                <h2>Dam-induced Migration</h2>
                <p>Dam induced migraiton was one of the major issues and difficulties. Around 200,000 people were displaced in Henan and Shanxi provinces. The loan from the World Bank contained the payments for compensation. </p>
                <p>Resettlement Risk and Control:</p>
                <p>1.Using Agriculture Resettlement Mode as the main mode. It is a land for land compensation strategy.</p>
                <p>2.Detailed analysis of the Resettlement Environment Capacity (REC) of host areas.</p>
                <p>3.Local government takes on resettlement responsibility, and the owner supervises the action.</p>
            </section>

            <section data-scene="government">
                <h2>Take away</h2>
                <p>Take a comprehensive look at the situation and consider historical data.</p>
                <p>Local government should play the role of mediator, mitigating conflicts between the state government and affected civilians.</p>
                <p>Consider local residents' needs and their perspectives.</p>
            </section>

            <section data-scene="end">
                <div class= "end-background-img background-fullscreen-setting text-center" >
                    <br/>
                    <h3 class="">Thanks for watching!!!</h3>
                </div>
            </section>

        </div>
        <!--map div-->
        <div id="map" class="col-sm-6 col-md-8 sidebar"></div>
    </div>
    <!--add a scrolling down arrow-->
    <div class="animated zoomIn infinite glyphicon glyphicon-menu-down arrow-down"></div>
    <!--add a navigation bar-->
    <div class="navbar text-center"></div>

    <!--add a info model -->
    <div id="loading">
        <i class="animated zoomIn infinite glyphicon glyphicon-globe"></i>
    </div>

    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fa fa-facebook-square btn" href="https://facebook.com/sharer.php?u=http://cdn.rawgit.com/winkyt/Xiaolangdi/master/index.html" target="_blank"></a>
        </dt>
        <dt>
            <!--facebook icon-->
            <a class="fa fa-git-square btn" href="https://github.com/winkyt/Xiaolangdi" style="top:40px" target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fa fa-file-text-o btn" style="top:60px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                    <p>This is a web map of Xiaolangdi Dam. It is mainly made as a mini project for a course GEOG 541: International Water Management provided by Oregon State University. The story map library is derived from the storymap plugin for leaflet at <a>http://atlefren.github.io/storymap/</a>, and its functionality relies on both leaflet and Boostrap.</p>
                    <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.1 | MIT License </p>
                    <p><b>Author: Yingqi Tang</b> | College of Earth, Ocean, Atmospheric Science | Oregon State University </p>
                    <p>The context about Xiaolangdi project from Xiaolangdi Construction and Management Center, Ministry of Water Resource.</p>
                    <p>The <a src="https://www.youtube.com/watch?v=XQNd1OzfiRQ">background video</a> on the front page was clipped from Youtube. </p>
                    <p>The favicon image was acquired from <a>http://www.udlcenter.org/advocacy/state/oregon.</a></p>
                    <p>This story map uses geospatial data from mapbox, Google Earth Engine, Microsoft Bing map, Open Street Maps and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- main javascript -->
<script type="text/javascript">

    $('html > head').append($("<style> .marker-icon { color: darkslategray; font-size: 15px; text-shadow: 0 0 3px #ffffff;} </style>"));
    // $('html > head').append($("<style> .marker-icon { color: #0000ff; font-size: 15px; text-shadow:1px 1px 2px #ffffff, 0 0 25px rgba(0,0,255,0.75), 0 0 5px rgba(0,0,139,0.78);} </style>")); // glow effect: https://adventuresinmapping.com/2016/10/17/firefly-cartography/

    var dams = L.geoJson.ajax('assets/dam.geojson', {
        pointToLayer: function (feature, latlng) {

            delay = 0;
            //delay =Math.floor(Math.random() * 400);

            return L.marker(latlng, {bounceOnAdd: true,  bounceOnAddOptions: {duration: 200, height: window.innerHeight, delay:delay}, icon: L.divIcon({className: 'glyphicon glyphicon-map-marker marker-icon'})});
        },
        onEachFeature: function (feature, layer) {
            layer.bindTooltip(feature.properties.DAM_NAME, {sticky: true, className: "feature-tooltip"});
        }
    });





    /**
     * Created by Yingqi.
     */
        // Create Legend Contents in html format
    var county_legend ='<i style="background: lightcoral; opacity: 0.6"></i><p><b>Counties</b></p>';
    var area_legend = '<i style="background: orange; opacity: 0.5"></i><p><b>Affected Area</b></p>';
    var urban_legend = '<i style="background: mediumpurple; opacity: 0.5"></i><p><b>Populated Area</b></p>';
    var river_legend= '<i style="background: lightskyblue; opacity: 1"></i><p><b>River</b></p>';
    var dams_legend ='<i class="glyphicon glyphicon-map-marker marker-icon"></i><p><b>Dam</b></p>';

    // For each layer, the first variable is the layer, the second is the legend. The layer variable can be any kinds of layers that leaflet.js supports.
    // var layers = {
    //      'layer1': [layer1, legend1]
    //      'layer2': [layer2, legend2]
    //      ...
    // }

    var layers = {
        'bing' : [L.tileLayer.bing('AuhiCJHlGzhg93IqUH_oCpl_-ZUrIE6SPftlyGYUvr9Amx5nzA-WqGcPquyFZl4L')],
        'river': [ L.geoJson.ajax('assets/yriver.geojson',  {
            color: 'lightskyblue',
            weight: 2,
            opacity: 0.8}), river_legend],
        'urban': [ L.geoJson.ajax('assets/urban.geojson',  {
            color: 'mediumpurple',
            weight: 2,
            opacity: 0.8}), urban_legend],
        'henan': [ L.geoJson.ajax('assets/area.geojson',  {
            color: 'orange',
            weight: 2,
            opacity: 0.8}), area_legend],
        'dams':[dams,dams_legend],
        'china': [ L.geoJson.ajax('assets/chnad.geojson',  {
            color: 'red',
            weight: 2,
            opacity: 0.3}), county_legend],
        'satellite': [ L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
            id: 'mapbox.satellite'
        })]
    };


    var scenes = {
        overview: {lat: 35.8613901, lng: 80.23771915, zoom: 4, position: 'fullpage', name: 'Cover Page'},
        yellowriver: {lat: 35.8613901, lng: 80.23771915, zoom: 5, name: 'Yellow River', layers:['china','river','dams']},
        history: {lat: 34.94140235, lng: 112.0636695, zoom: 10, name: 'History', layers: ['bing','henan']},
        construction: {lat: 34.922506, lng: 112.364742, zoom: 15, name: 'Construction' },
        stakeholders: {lat: 34.922506, lng: 112.334742, zoom: 14, name: 'Stakeholders'},
        environment: {lat: 34.956820, lng: 112.364993, zoom: 15, name: 'Environment Management'},
        displacement: {lat: 34.956820, lng: 112.364993, zoom: 11, name: 'Dam-induced migration', layers: ['urban']},
        government:{lat: 37.52967646, lng: 127.05102134, zoom: 12, name: 'Government'},
        end: {lat: 36.1478412, lng:110.4495348, zoom: 12, name: 'The End', position: 'fullpage'}
    };

    $('.main').storymap({
        scenes: scenes,
        layers: layers,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        scale: true,
        navbar: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map('map', {zoomControl: false, scrollWheelZoom: false});

            // add an base map, which can be either OSM, mapbox, tilelayer, wmslayer or those designed by yourself.
            L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                maxZoom: 18,
                attribution: '<a href="http://ceoas.oregonstate.edu/profile/zhao/" target="_blank">Bo Zhao</a>',
                id: 'mapbox.light' // ,detectRetina: true
            }).addTo(map);


            // create a mini globe as the overview map control.
            var miniMap = new L.Control.GlobeMiniMap({
                marker:'red',
                position: 'bottomright'
            }).addTo(map);

            // hidden the credits, but show in the about page.
            $(".leaflet-control-attribution").css("display", "none");

            return map;
        }
    });
</script>
</body>
</html>